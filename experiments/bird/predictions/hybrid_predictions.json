[
  "SELECT \n    frpm.percent_free_k12 AS eligible_free_rate\nFROM \n    california_schools.frpm\nWHERE \n    frpm.county_code = '001'\nORDER BY \n    frpm.percent_free_k12 DESC\nLIMIT 1",
  "SELECT \n    frpm.percent_eligible_frpm_ages_5_17 AS eligible_free_rate\nFROM \n    california_schools.frpm\nWHERE \n    frpm.charter_school = 'y'\n    AND frpm.district_type = 'continuation'\nORDER BY \n    frpm.percent_eligible_frpm_ages_5_17 ASC\nLIMIT 3",
  "SELECT s.zip\nFROM \n    california_schools.frpm AS f\n    JOIN california_schools.schools AS s \n    ON f.cdscode = s.cdscode\nWHERE \n    f.charter_school = 'Y' \n    AND f.county_code = '057'",
  "SELECT sc.street\nFROM california_schools.schools sc\nJOIN california_schools.frpm scfrpm ON sc.cdscode = scfrpm.cdscode\nWHERE scfrpm.frpm_count_12 = (SELECT MAX(frpm_count_12) FROM california_schools.frpm)",
  "SELECT \n  s.phone\nFROM \n  schools s\n  JOIN frpm f ON s.cdscode = f.cdscode\nWHERE \n  f.charter_school = '1'\n  AND s.opendate > '2000-01-01'\n  AND s.statustype = 'Open'",
  "SELECT COUNT(*)\nFROM satscores, schools\nWHERE satscores.cds = schools.cdscode\nAND avgscrmath > 400\nAND virtual = 'F'",
  "SELECT s.school, s.magnet \nFROM schools s \nJOIN satscores sc ON s.cdscode = sc.cds \nWHERE sc.numtsttakr > 500 AND s.magnet = '1'",
  "SELECT sc.phone\nFROM satscores s\nJOIN schools sc ON s.cds = sc.cdscode\nWHERE s.avgscrread > 1500\nORDER BY s.numtsttakr DESC\nLIMIT 1",
  "",
  "SELECT COUNT(DISTINCT sch.cdscode)\nFROM satscores s\nJOIN schools sch ON s.cds = sch.cdscode\nWHERE s.avgscrmath > 560\nAND sch.fundingtype = 'Charter'",
  "SELECT \n    frpm.frpm_count AS frpm_count_5_17\nFROM \n    satscores\nJOIN \n    schools ON satscores.cds = schools.cdscode\nJOIN \n    frpm ON schools.cdscode = frpm.cdscode\nWHERE \n    satscores.rtype = 'SAT'\n    AND satscores.avgscrread = (\n        SELECT \n            AVG(avgscrread) \n        FROM \n            satscores \n        GROUP BY \n            rtype \n        ORDER BY \n            AVG(avgscrread) DESC \n        LIMIT 1\n    )\nORDER BY \n    frpm_count_5_17",
  "SELECT \n  s.cdscode\nFROM \n  california_schools.frpm s\nWHERE \n  s.enrollment(k-12) + s.enrollment(ages 5-17) > 500",
  "SELECT \n    s.name, \n    s.district_name, \n    s.county_name, \n    (frpm.frpm_count_ages_5_17 / frpm.enrollment_ages_5_17) AS eligible_free_rate\nFROM \n    satscores s\nJOIN \n    frpm ON s.cds = frpm.cdscode\nWHERE \n    s.avgscrread > 0.3\nORDER BY \n    eligible_free_rate DESC\nLIMIT 1",
  "SELECT s.phone\nFROM schools s\nJOIN satscores sc ON s.cdscode = sc.cds\nORDER BY sc.numge1500/sc.numtsttakr DESC\nLIMIT 3",
  "SELECT s.cdscode, COUNT(s.enrollment_ages_5_17) AS enrollment_count\nFROM \n    california_schools.frpm AS s\nWHERE \n    s.enrollment_ages_5_17 > 0\nGROUP BY \n    s.cdscode\nORDER BY \n    enrollment_count DESC\nLIMIT 5",
  "SELECT \n    d.name AS district_name,\n    AVG(s2.avgscrread) AS avg_reading_score\nFROM \n    schools s\nJOIN \n    frpm f ON s.cdscode = f.cdscode\nJOIN \n    schools s2 ON s.cdscode = s2.cdscode\nJOIN \n    districts d ON s.ncesdist = d.cdscode\nWHERE \n    s.statustype = 'Active'\n    AND f.nslp_provision_status = 'Yes'\n    AND f.charter_school = 'No'\nGROUP BY \n    d.name\nORDER BY \n    avg_reading_score DESC\nLIMIT 1",
  "SELECT COUNT(*)\nFROM schools\nWHERE county = 'Alameda'\nAND EXISTS (\n  SELECT 1\n  FROM satscores\n  WHERE schools.cdscode = satscores.cds\n  AND numtsttakr < 100\n)",
  "SELECT \n    schools.school_name, \n    schools.district_name, \n    schools.charter_number, \n    satscores.avgscrwrite\nFROM \n    schools\nINNER JOIN \n    satscores ON schools.cdscode = satscores.cds\nWHERE \n    satscores.avgscrwrite > 499\nAND \n    schools.charter_number IS NOT NULL\nORDER BY \n    satscores.avgscrwrite DESC",
  "SELECT COUNT(DISTINCT s.cdscode)\nFROM schools s\nJOIN satscores ss ON s.cdscode = ss.cds\nWHERE s.county = 'Fresno'\nAND s.fundingtype = 'Directly Funded'\nAND ss.numtsttakr <= 250",
  "SELECT \n  s.phone\nFROM \n  schools s\n  JOIN \n    satscores sc ON s.cdscode = sc.cds\nORDER BY \n  sc.avgscrmath DESC\nLIMIT 1",
  "SELECT COUNT(*)\nFROM \n    frpm \nWHERE \n    county_code = '031'\n    AND low_grade = 9\n    AND high_grade = 12",
  "SELECT COUNT(*)\nFROM california_schools.frpm\nWHERE county_code = 'Los Angeles'\nAND (free_meal_count(k-12) > 500 AND free_meal_count(k-12) < 700)",
  "SELECT sname, numtsttakr\nFROM satscores\nINNER JOIN schools ON satscores.cds = schools.cdscode\nWHERE schools.county = 'Contra Costa'\nORDER BY numtsttakr DESC\nLIMIT 1",
  "SELECT \n    s.school_name, \n    s.street, \n    s.streetabr, \n    s.city, \n    s.zip, \n    s.phone, \n    s.ext, \n    s.website, \n    s.opendate, \n    s.closeddate, \n    s.charter, \n    s.charternum, \n    s.fundingtype, \n    s.doc, \n    s.doctype, \n    s.soc, \n    s.soctype, \n    s.edopscode, \n    s.edopsname, \n    s.eilcode, \n    s.eilname, \n    s.gsoffered, \n    s.gsserved, \n    s.virtual,",
  "SELECT s.school_name\nFROM frpm f\nJOIN schools s ON f.cdscode = s.cdscode\nWHERE f.percent_eligible_frpm_k12 > 0.1\nAND EXISTS (\n  SELECT 1\n  FROM satscores sc\n  WHERE sc.cds = f.cdscode\n  AND sc.numge1500 >= 1500\n)",
  "SELECT \n    s.school_name, \n    s.fundingtype\nFROM \n    schools s\nJOIN \n    satscores ss ON s.cdscode = ss.cds\nWHERE \n    s.county = 'Riverside'\n    AND ss.avgscrmath > 400\nGROUP BY \n    s.school_name, \n    s.fundingtype",
  "SELECT \n    s.school, \n    s.street, \n    s.city, \n    s.state, \n    s.zip\nFROM \n    schools s\nJOIN \n    frpm f ON s.cdscode = f.school code\nWHERE \n    f.county code = '011' \n    AND f.school type = 'High School' \n    AND f.enrollment (ages 5-17) > 800 \n    AND f.percent (%) eligible free (ages 5-17) > 0 \n    AND f.percent (%) eligible frpm (ages 5-17) > 0",
  "SELECT \n  s.school_name, \n  satscores.avgscrwrite, \n  s.phone\nFROM \n  schools s \n  INNER JOIN satscores ON s.cdscode = satscores.cds\nWHERE \n  (s.opendate > '1991-01-01' OR s.closeddate < '2000-01-01')\n  AND s.phone IS NOT NULL\nORDER BY \n  s.school_name",
  "SELECT \n    s.school_name, \n    s.doc\nFROM \n    schools s\nWHERE \n    s.fundingtype = 'Locally Funded'\n    AND \n    (s.enrollment_k_12 - s.enrollment_ages_5_17) > \n    (SELECT AVG(s1.enrollment_k_12 - s1.enrollment_ages_5_17) \n     FROM schools s1 \n     WHERE s1.fundingtype = 'Locally Funded')",
  "SELECT \n    s.opendate \nFROM \n    schools s \nWHERE \n    s.statustype = 'Open' \n    AND s.grade_level = 'K-12' \n    AND s.enrollment (k-12) = (SELECT MAX(enrollment (k-12)) FROM schools WHERE statustype = 'Open' AND grade_level = 'K-12')",
  "SELECT \n    s.city,\n    COUNT(f.enrollment) AS total_enrollment\nFROM \n    california_schools.frpm f\nJOIN \n    california_schools.schools s ON f.cdscode = s.cdscode\nWHERE \n    f.low_grade = 1 AND f.high_grade = 12\nGROUP BY \n    s.city\nORDER BY \n    total_enrollment ASC\nLIMIT 5",
  "SELECT \n    s.cdscode, \n    s.school, \n    (sf.frm_count_k_12 / sf.enrollment_k_12) * 100 AS eligible_free_rate\nFROM \n    california_schools.frpm sf\nJOIN \n    california_schools.schools s ON sf.cdscode = s.cdscode\nWHERE \n    sf.low_grade = 1 \n    AND sf.high_grade = 12\nORDER BY \n    sf.enrollment_k_12 DESC\nLIMIT 10",
  "",
  "SELECT \n  s.school_name AS school_name, \n  s.website AS website\nFROM \n  california_schools.frpm AS frpm\n  JOIN california_schools.schools AS s ON frpm.cdscode = s.cdscode\nWHERE \n  frpm.enrollment_ages_5_17 BETWEEN 1900 AND 2000\n  AND frpm.percent_eligible_free_ages_5_17 > 0",
  "SELECT \n  frpm.frpm_count_ages_5_17 AS free_meal_count,\n  frpm.enrollment_ages_5_17 AS enrollment,\n  ROUND(frpm.frpm_count_ages_5_17 / frpm.enrollment_ages_5_17 * 100, 2) AS eligible_free_rate\nFROM \n  california_schools.frpm AS frpm\nWHERE \n  frpm.county_name = 'Alameda' \n  AND frpm.district_name = 'Alameda Unified School District' \n  AND frpm.school_name = 'Kacey Gibson Elementary School'",
  "SELECT \n    admemail1 \nFROM \n    schools \nWHERE \n    charter = '1' \nORDER BY \n    (SELECT enrollment (k-12) FROM frpm WHERE schools.cdscode = frpm.cdscode) \nLIMIT 1",
  "SELECT \n    s.admfname1, s.admlname1, \n    CONCAT(s.admfname1,'', s.admlname1) AS full_name\nFROM \n    schools s\nJOIN \n    satscores ss ON s.cdscode = ss.cds\nWHERE \n    ss.numge1500 > 0\nORDER BY \n    ss.numge1500 DESC\nLIMIT 1",
  "SELECT \n    s.street, s.city, s.zip, s.state\nFROM \n    schools s\nJOIN \n    satscores sc ON s.cdscode = sc.cds\nWHERE \n    sc.numtsttakr > 0\nORDER BY \n    sc.numge1500 / sc.numtsttakr ASC\nLIMIT 1",
  "SELECT s.website\nFROM schools s\nJOIN satscores sc ON s.cdscode = sc.cds\nWHERE s.county = 'Los Angeles' \nAND sc.numtsttakr BETWEEN 2000 AND 3000",
  "SELECT AVG(numtsttakr) \nFROM satscores \nWHERE rtype = 'Fresno' \n  AND sname IN (\n    SELECT school \n    FROM schools \n    WHERE opendate BETWEEN '1980-01-01' AND '1980-12-31'\n  )",
  "SELECT s.phone\nFROM schools s\nJOIN satscores sc ON s.cdscode = sc.cds\nWHERE sc.avgscrread = (SELECT MIN(avgscrread) FROM satscores WHERE satscores.dname = 'Fresno Unified')\nORDER BY sc.avgscrread",
  "SELECT \n  sch.school_name\nFROM \n  satscores s\n  JOIN schools sch ON s.cds = sch.cdscode\nWHERE \n  s.rtype = 'F'  -- exclusively virtual\n  AND s.avgscrread >= (SELECT AVG(avgscrread) FROM satscores WHERE rtype = 'F' AND cds = s.cds ORDER BY avgscrread DESC LIMIT 1 OFFSET 4)\n  AND sch.county = s.county\n  AND sch.school_name IS NOT NULL\nORDER BY \n  s.county, \n  sch.school_name",
  "SELECT \n    s.name, \n    d.name, \n    c.name, \n    satscores.avgscrmath \nFROM \n    satscores \nJOIN \n    schools s ON satscores.cds = s.cdscode \nJOIN \n    districts d ON s.ncesdist = d.cdscode \nJOIN \n    counties c ON s.county = c.cdscode \nORDER BY \n    satscores.avgscrmath DESC \nLIMIT \n    1",
  "SELECT \n    AVG(satscores.avgscrmath) AS avg_math_score,\n    schools.county\nFROM \n    satscores\nINNER JOIN \n    schools ON satscores.cds = schools.cdscode\nWHERE \n    satscores.rtype = 'S'\nGROUP BY \n    schools.county\nORDER BY \n    AVG(satscores.avgscrmath) ASC\nLIMIT 1",
  "SELECT \n  s2.school, \n  AVG(s.avgscrwrite) AS avg_write_score, \n  s2.city\nFROM \n  satscores s\n  JOIN schools s2 ON s.cds = s2.cdscode\nWHERE \n  s.numtsttakr = (\n    SELECT \n      MAX(numtsttakr) \n    FROM \n      satscores\n    WHERE \n      avgscrread + avgscrmath + avgscrwrite >= 1500\n  )\nGROUP BY \n  s2.school, \n  s2.city",
  "SELECT \n    s.school_name,\n    AVG(satscores.avgscrwrite) AS avg_writing_score\nFROM \n    schools s\nJOIN \n    satscores ON s.cdscode = satscores.cds\nWHERE \n    s.statustype = 'Active' AND \n    s.admfname1 = 'Ricci' AND \n    s.admlname1 = 'Ulrich'\nGROUP BY \n    s.school_name",
  "SELECT \n    s.school, \n    COUNT(f.cdscode) AS total_enrollment\nFROM \n    schools s \n    JOIN frpm f ON s.cdscode = f.cdscode\nWHERE \n    s.statustype = '31' \n    AND f.low_grade = '1' \n    AND f.high_grade = '12'\nGROUP BY \n    s.school\nORDER BY \n    total_enrollment DESC",
  "SELECT \n    COUNT(s.cdscode) / 12 AS monthly_avg_opened_schools\nFROM \n    schools s\nWHERE \n    s.county = 'Alameda'\n    AND s.statustype = 'Elementary School District'\n    AND s.opendate LIKE '%1980%'",
  "SELECT \n    (COUNT(DISTINCT s1.cdscode) / COUNT(DISTINCT s2.cdscode)) AS ratio\nFROM \n    schools s1\n    JOIN schools s2 ON s1.cdscode = s2.cdscode\nWHERE \n    s1.county = 'Orange' AND \n    s1.doc = 54 AND \n    s2.doc = 52",
  "SELECT \n  s.county, \n  s.school, \n  s.closeddate AS closure_date\nFROM \n  schools s\nWHERE \n  s.statustype = 'Closed'\nGROUP BY \n  s.county, \n  s.school\nORDER BY \n  COUNT(s.county) DESC",
  "",
  "SELECT \n  s.mailstreet, \n  s.sname \nFROM \n  schools s \n  JOIN satscores sc ON s.cdscode = sc.cds \nORDER BY \n  sc.avgscrread \nLIMIT 1",
  "SELECT COUNT(*)\nFROM schools\nJOIN satscores ON schools.cdscode = satscores.cds\nWHERE satscores.avgscrread + satscores.avgscrmath + satscores.avgscrwrite >= 1500\nAND schools.mailcity = 'Lakeport'",
  "SELECT COUNT(satscores.numtsttakr)\nFROM satscores\nJOIN schools ON satscores.cds = schools.cdscode\nWHERE schools.mailcity = 'Fresno'",
  "SELECT \n    s.cdscode, \n    s.street, \n    s.zip, \n    s.mailzip\nFROM \n    schools s\nWHERE \n    (s.admfname1 = 'Avetik Atoian' OR \n    s.admfname2 = 'Avetik Atoian' OR \n    s.admfname3 = 'Avetik Atoian')\nORDER BY \n    s.cdscode",
  "SELECT \n    COUNT(CASE WHEN s.county = 'Colusa' THEN 1 ELSE NULL END) AS ratio_colusa_to_humboldt,\n    COUNT(CASE WHEN s.county = 'Humboldt' THEN 1 ELSE NULL END) AS count_humboldt\nFROM \n    schools s\nWHERE \n    s.state = 'CA'\nGROUP BY \n    s.county",
  "SELECT COUNT(DISTINCT s.cdscode)\nFROM schools s\nWHERE s.state = 'CA' AND s.city = 'San Joaquin' AND s.statustype = 'Active'",
  "SELECT \n    sc.phone, sc.ext\nFROM \n    satscores s\nJOIN \n    schools sc ON s.cds = sc.cdscode\nORDER BY \n    s.avgscrwrite DESC\nOFFSET 332 ROWS\nFETCH NEXT 1 ROW ONLY",
  "SELECT s.phone, s.ext, s.school\nFROM schools s\nWHERE s.zip = '95203-3704'",
  "SELECT \n  s.website \nFROM \n  schools s \nWHERE \n  (s.admfname1 = 'Mike Larson' \n  OR s.admfname2 = 'Mike Larson' \n  OR s.admfname3 = 'Mike Larson') \n  OR (s.admfname1 = 'Dante Alvarez' \n  OR s.admfname2 = 'Dante Alvarez' \n  OR s.admfname3 = 'Dante Alvarez')",
  "SELECT s.website\nFROM schools s\nWHERE s.charter = 1 AND s.virtual = 'P' AND s.county = 'San Joaquin'",
  "SELECT COUNT(*)\nFROM schools\nWHERE city = 'Hickman'\nAND charter = 1\nAND doc = 52",
  "SELECT COUNT(*)\nFROM schools\nJOIN frpm ON schools.cdscode = frpm.cdscode\nWHERE schools.county = 'Los Angeles'\nAND schools.charter = 0\nAND (frpm.percent(%) eligible free (k-12)) < 0.18",
  "SELECT s.school, s.city, \n       admfname1 ||' '|| admlname1 AS admin_name,\n       admfname2 ||' '|| admlname2 AS admin_name,\n       admfname3 ||' '|| admlname3 AS admin_name\nFROM schools s\nWHERE s.charter = 1 AND s.charternum = '00D2'\nORDER BY s.school, s.city",
  "SELECT COUNT(*)\nFROM schools\nWHERE city = 'Hickman'\nAND charter = 'Y'\nAND charternum = '00D4'",
  "SELECT \n    (COUNT(CASE WHEN charter_funding_type = 'Locally Funded' THEN 1 ELSE NULL END) / \n     COUNT(CASE WHEN charter_funding_type IS NOT NULL THEN 1 ELSE NULL END)) * 100 AS locally_funded_ratio\nFROM \n    frpm\nWHERE \n    county_code = '053'",
  "SELECT COUNT(*)\nFROM schools\nWHERE \n  opendate BETWEEN '2000-01-01' AND '2005-12-31'\n  AND county = 'Stanislaus'\n  AND fundingtype = 'Directly Funded'",
  "SELECT \n    SUM(closedate) AS total_closure\nFROM \n    schools\nWHERE \n    county = 'San Francisco'\n    AND statustype = 'Community College District'\n    AND closeddate = '1989'",
  "SELECT \n  s.county, \n  COUNT(s.closeddate) AS num_closures\nFROM \n  schools s\nWHERE \n  s.statustype = 'Closed' \n  AND s.charter = 'N' \n  AND s.opendate <= '1989-12-31' \n  AND s.closeddate >= '1980-01-01' \n  AND s.soc = 11 \nGROUP BY \n  s.county\nORDER BY \n  num_closures DESC",
  "SELECT s.ncesdist \nFROM schools s \nWHERE s.soc = 31",
  "SELECT \n  COUNT(*) \nFROM \n  california_schools.schools \n  INNER JOIN california_schools.frpm ON california_schools.schools.cdscode = california_schools.frpm.cdscode\nWHERE \n  county = 'Alpine' \n  AND (statustype = 'Active' OR statustype = 'Closed') \n  AND edopsname = 'Community Day School'\n  AND edopscode LIKE 'District%'\n  AND educational_option_type = 'Community Day School'",
  "SELECT s.district_code\nFROM california_schools.schools s\nWHERE s.city = 'Fresno' AND s.magnet = 0",
  "SELECT COUNT(s.enrollment(ages 5-17))\nFROM california_schools.frpm AS s\nJOIN california_schools.schools AS sc\nON s.cdscode = sc.cdscode\nWHERE s.academic_year = '2014-2015'\nAND sc.statustype = 'State Special School'\nAND sc.county = 'Fremont'\nAND s.low_grade <= 17\nAND s.high_grade >= 5",
  "SELECT \n    frpm.frpm_count AS frpm_count\nFROM \n    california_schools.frpm\nJOIN \n    california_schools.schools ON frpm.cdscode = schools.cdscode\nWHERE \n    schools.school_name = 'Youth Authority School'\n    AND schools.mailstreet = 'PO Box 1040'\n    AND frpm.enrollment_ages_517 = 'yes'",
  "SELECT \n    MIN(LOW_GRADE) AS LOWEST_GRADE\nFROM \n    california_schools.frpm \nWHERE \n    DISTRICT_CODE = '0613360' \n    AND DISTRICT_TYPE = 'SPECON'",
  "SELECT \n  s.school_name AS school_name, \n  e.educational_option_type AS educational_level_name\nFROM \n  schools s\n  JOIN frpm f ON s.cdscode = f.school_code\n  JOIN satscores se ON s.cdscode = se.cds\nWHERE \n  f.county_code = 37 AND \n  f.breakfast_provision = '2'",
  "SELECT \n  s.street, \n  s.city, \n  s.zip\nFROM \n  schools s\n  JOIN frpm f ON s.cdscode = f.cdscode\nWHERE \n  f.low_grade = 9 \n  AND f.high_grade = 12 \n  AND f.county_code = '031' \n  AND f.educational_option_type = '2' \n  AND s.statustype = 'HS'\n  AND f.charter_school = 'N'",
  "SELECT \n  s.school_name AS School_Name,\n  (f.frpm_count_ages_5_17 / f.enrollment_ages_5_17) * 100 AS Percent_Eligible_FRPM_Ages_5_17\nFROM \n  frpm f\n  JOIN schools s ON f.cdscode = s.cdscode\nWHERE \n  f.county_code = '031' AND\n  f.low_grade = 'K' AND\n  f.high_grade = '9'\nORDER BY \n  Percent_Eligible_FRPM_Ages_5_17 DESC",
  "SELECT \n    s.school_name, \n    COUNT(*) AS count\nFROM \n    schools s\nWHERE \n    s.city = 'Adelanto'\nGROUP BY \n    s.school_name\nORDER BY \n    count DESC\nLIMIT 1",
  "SELECT \n  s.county, \n  COUNT(*) AS num_schools\nFROM \n  california_schools.schools s\n  JOIN california_schools.frpm f ON s.cdscode = f.cdscode\nWHERE \n  s.county BETWEEN 'San Diego' AND 'Santa Barbara'\n  AND f.virtual = 'F'\nGROUP BY \n  s.county\nORDER BY \n  num_schools DESC\nLIMIT 1",
  "SELECT \n  s.school_name, \n  s.latitude\nFROM \n  schools s\nWHERE \n  s.latitude = (SELECT MAX(latitude) FROM schools)",
  "SELECT \n    s.city, \n    s.school, \n    f.low_grade\nFROM \n    schools s\nJOIN \n    frpm f ON s.cdscode = f.cdscode\nWHERE \n    s.state = 'CA'\nORDER BY \n    s.latitude\nLIMIT 1",
  "SELECT \n  gsoffered\nFROM \n  schools\nWHERE \n  latitude IS NOT NULL \n  AND longitude IS NOT NULL \nORDER BY \n  ABS(longitude) DESC \nLIMIT 1",
  "SELECT \n    s.city, \n    COUNT(s.school) AS num_schools, \n    COUNT(CASE WHEN s.magnet = 1 AND s.grade_span = 'K-8' THEN 1 ELSE NULL END) AS num_magnet_schools\nFROM \n    schools s\nWHERE \n    s.grade_span = 'K-8' AND s.magnet = 1\nGROUP BY \n    s.city",
  "SELECT \n    s.admfname1, \n    s.admfname2, \n    s.admfname3, \n    d.district_name\nFROM \n    schools s \nJOIN \n    districts d ON s.ncesdist = d.cdscode\nWHERE \n    s.admfname1 IS NOT NULL OR s.admfname2 IS NOT NULL OR s.admfname3 IS NOT NULL\nGROUP BY \n    s.admfname1, \n    s.admfname2, \n    s.admfname3, \n    d.district_name\nORDER BY \n    COUNT(*) DESC\nLIMIT 2",
  "SELECT \n    f.district_code, \n    (f.free_meal_count_k12 / f.enrollment_k12) * 100 AS percent_eligible_free_k12\nFROM \n    frpm f\nJOIN \n    schools s ON f.cdscode = s.cdscode\nWHERE \n    f.academic_year = '2013-14'\n    AND s.admfname1 = 'Alusine'\nORDER BY \n    percent_eligible_free_k12 DESC",
  "SELECT \n    s.admlname1 AS Administrator_Last_Name\n, s.district_name AS District\n, s.county_name AS County\n, s.school_name AS School_Name\nFROM \n    schools s\nWHERE \n    s.cdscode IN (\n        SELECT \n            school_code\n        FROM \n            frpm\n        WHERE \n            charter_school = 'Y'\n            AND charter_school_number = 40\n    )",
  "SELECT \n    s.admemail1, s.admemail2, s.admemail3\nFROM \n    schools s\nWHERE \n    s.county = 'San Bernardino'\n    AND s.district = 'San Bernardino City Unified'\n    AND s.opendate BETWEEN '2009-01-01' AND '2010-12-31'\n    AND (s.statustype = 'Public Intermediate/Middle Schools' OR s.statustype = 'Unified Schools')\n    AND (s.admemail1 IS NOT NULL OR s.admemail2 IS NOT NULL OR s.admemail3 IS NOT NULL)",
  "SELECT \n    s.admemail1 AS administrator_email, \n    s.school_name AS school_name\nFROM \n    schools s\nJOIN \n    satscores ss ON s.cdscode = ss.cds\nWHERE \n    ss.numtsttakr > 0 AND ss.avgscrread >= 1500\nORDER BY \n    ss.numtsttakr DESC\nLIMIT 1",
  "SELECT COUNT(*)\nFROM account\nJOIN client ON account.client_id = client.client_id\nJOIN district ON client.district_id = district.district_id\nWHERE district.a3 LIKE '%POPLATEK PO OBRATU%' AND district.a3 LIKE '%V\u00fdchodn\u00ed \u010cechy%'",
  "SELECT COUNT(DISTINCT a.account_id)\nFROM account a\nJOIN client c ON a.client_id = c.client_id\nJOIN district d ON c.district_id = d.district_id\nWHERE d.a3 LIKE '%Prague%'\nAND EXISTS (\n  SELECT 1\n  FROM loan l\n  WHERE l.account_id = a.account_id\n  AND l.status = 'active'\n)",
  "",
  "SELECT COUNT(DISTINCT d.a2) AS no_of_districts\nFROM district d\nJOIN client c ON d.district_id = c.district_id\nJOIN disp d1 ON c.client_id = d1.client_id\nJOIN account a ON d1.account_id = a.account_id\nWHERE a.a11 > 6000 AND a.a11 < 10000 AND c.gender = 'F'",
  "SELECT COUNT(*)\nFROM client c\nJOIN district d ON c.district_id = d.district_id\nWHERE c.gender = 'M'\nAND d.a11 > 8000\nAND d.a3 LIKE '%North Bohemia%'",
  "SELECT \n  a.account_id, \n  (d.a11 - d.a2) AS gap\nFROM \n  client c\n  JOIN district d ON c.district_id = d.district_id\n  JOIN account a ON c.client_id = a.client_id\nWHERE \n  c.gender = 'F'\nORDER BY \n  c.birth_date DESC, \n  d.a2 ASC\nLIMIT 1",
  "SELECT \n    a.account_id\nFROM \n    client c\nJOIN \n    district d ON c.district_id = d.district_id\nJOIN \n    account a ON c.client_id = a.client_id\nWHERE \n    c.birth_date = (SELECT MIN(birth_date) FROM client)\n    AND d.a11 = (SELECT MAX(a11) FROM district)\nORDER BY \n    c.birth_date, d.a11",
  "SELECT COUNT(*)\nFROM client\nWHERE client.gender = 'Owner'\nAND EXISTS (\n  SELECT 1\n  FROM disp\n  WHERE disp.client_id = client.client_id\n  AND disp.type = 'POPLATEK TYDNE'\n)",
  "SELECT client_id\nFROM client\nWHERE (SELECT disp_id FROM disp WHERE disp.type = 'Disponent') = (SELECT disp_id FROM disp WHERE disp.client_id = client.client_id AND disp.type = 'POPLATEK PO OBRATU')",
  "SELECT \n  a.account_id, \n  c.client_id, \n  c.gender, \n  c.birth_date, \n  d.district_id, \n  d.a2, \n  d.a3, \n  d.a4, \n  d.a5, \n  d.a6, \n  d.a7, \n  d.a8, \n  d.a9, \n  d.a10, \n  d.a11, \n  d.a12, \n  d.a13, \n  d.a14, \n  d.a15, \n  d.a16, \n  l.amount AS loan_amount, \n  'POPLATEK TYDNE' AS statement\nFROM \n  account",
  "SELECT \n  a.account_id, \n  a.frequency, \n  a.date, \n  l.amount AS loan_amount\nFROM \n  account a \n  JOIN loan l ON a.account_id = l.account_id\nWHERE \n  l.duration > 12 \n  AND a.date LIKE '1993%'\n  AND l.amount = (SELECT MAX(l2.amount) FROM loan l2 WHERE l2.duration > 12)\nORDER BY \n  a.date",
  "SELECT \n    COUNT(*)\nFROM \n    client\nWHERE \n    gender = 'F' \n    AND birth_date < '1950-01-01' \n    AND district_id IN \n        (SELECT \n             district_id \n         FROM \n             district \n         WHERE \n             a2 = 'Sokolov')",
  "SELECT a.account_id, MIN(a.date) AS earliest_date\nFROM account a\nWHERE a.date LIKE '1995%'\nGROUP BY a.account_id\nORDER BY earliest_date ASC\nLIMIT 1",
  "SELECT DISTINCT \n    a.account_id, \n    a.district_id, \n    a.frequency, \n    a.date \nFROM \n    financial.account a \nWHERE \n    a.date < '1997-01-01' \n    AND a.amount > 3000",
  "SELECT client.client_id \nFROM client \nJOIN disp ON client.client_id = disp.client_id \nJOIN card ON disp.disp_id = card.disp_id \nWHERE card.issued = '1994-03-03'",
  "SELECT \n  a.date \nFROM \n  account a \n  INNER JOIN client c \n  ON a.client_id = c.client_id \nWHERE \n  a.frequency ='monthly' \n  AND a.date <= '1998-10-14' \n  AND a.balance = 840 \n  AND a.type = 'opening'",
  "SELECT \n  a.district_id \nFROM \n  account a \n  JOIN \n  loan l ON a.account_id = l.account_id \nWHERE \n  l.date = '1994-08-25' \n  AND l.status = 'approved'",
  "SELECT MAX(t.amount)\nFROM \n  trans t\n  JOIN client c ON t.account_id = (SELECT account_id FROM disp WHERE disp_id = (SELECT disp_id FROM card WHERE issued = '1996-10-21'))\n  JOIN card ca ON t.account_id = ca.disp_id\nWHERE \n  ca.issued = '1996-10-21'",
  "SELECT \n    c.gender \nFROM \n    client c \nJOIN \n    account a ON c.client_id = a.account_id \nJOIN \n    district d ON c.district_id = d.district_id \nJOIN \n    (\n        SELECT \n            d.district_id, AVG(A11) AS avg_salary \n        FROM \n            district d \n        GROUP BY \n            d.district_id \n        ORDER BY \n            avg_salary DESC \n        LIMIT 1 \n    ) AS high_salary_district \nON \n    d.district_id = high_salary_district.district_id \nJOIN \n    (\n        SELECT \n            client_id, MIN(birth_date) AS min_birth_date \n        FROM \n            client \n        GROUP BY)",
  "SELECT \n  c.client_id, \n  c.gender, \n  c.birth_date, \n  c.district_id, \n  t.date, \n  t.amount\nFROM \n  client c \n  INNER JOIN account a ON c.client_id = a.account_id \n  INNER JOIN trans t ON a.account_id = t.account_id \nWHERE \n  c.client_id = (SELECT client_id FROM loan WHERE amount = (SELECT MAX(amount) FROM loan)) \n  AND t.date = (SELECT MIN(date) FROM trans WHERE account_id = (SELECT account_id FROM client WHERE client_id = c.client_id))",
  "SELECT COUNT(*)\nFROM client c\nJOIN account a ON c.district_id = a.district_id\nWHERE a.district_id IN (SELECT district_id FROM district WHERE a2 = 'Jesenik') AND c.gender = 'F'",
  "SELECT d.disp_id\nFROM client c\nJOIN disp d ON c.client_id = d.client_id\nJOIN account a ON d.account_id = a.account_id\nJOIN trans t ON a.account_id = t.account_id\nWHERE t.date = '1998-09-02' AND t.amount = 5100",
  "SELECT COUNT(*)\nFROM account\nWHERE district_id IN (\n  SELECT district_id\n  FROM district\n  WHERE a2 = 'Litomerice'\n) AND date BETWEEN '1996-01-01' AND '1996-12-31'",
  "SELECT d.a2\nFROM client c\nJOIN account a ON c.client_id = a.account_id\nJOIN district d ON c.district_id = d.district_id\nWHERE c.gender = 'F' AND c.birth_date = '1976-01-29'",
  "SELECT c.birth_date\nFROM client c\nJOIN disp d ON c.client_id = d.client_id\nJOIN account a ON d.account_id = a.account_id\nJOIN loan l ON a.account_id = l.account_id\nWHERE l.date = '1996-01-03' AND l.amount = 98832",
  "SELECT a.account_id\nFROM financial.client c\nJOIN financial.account a ON c.client_id = a.client_id\nJOIN financial.district d ON c.district_id = d.district_id\nWHERE d.a3 = 'Prague'\nORDER BY c.client_id ASC\nLIMIT 1",
  "",
  "SELECT \n    client.client_id, \n    client.gender, \n    client.birth_date, \n    client.district_id, \n    account.account_id, \n    account.date, \n    account.balance, \n    ((account.balance - LAG(account.balance) OVER (PARTITION BY client.client_id ORDER BY account.date)) / LAG(account.balance) OVER (PARTITION BY client.client_id ORDER BY account.date)) * 100 AS increase_rate\nFROM \n    client \nJOIN \n    account ON client.client_id = account.client_id\nWHERE \n    client.client_id IN (\n        SELECT \n            client_id \n        FROM \n            loan \n        WHERE \n            date = '1993-07-05')",
  "SELECT \n    (SUM(CASE WHEN l.status = 'A' THEN l.amount ELSE 0 END) / SUM(l.amount)) * 100 AS percentage_paid\nFROM \n    loan l\nWHERE \n    l.status = 'A'",
  "SELECT \n    ROUND(\n        (\n            SUM(\n                CASE WHEN l.status = 'C' AND l.amount < 100000 THEN 1 ELSE 0 END\n            ) / \n            (SELECT SUM(l.amount) FROM loan l) \n        ) * 100, 2\n    ) AS percentage\nFROM \n    loan l\nWHERE \n    l.status = 'C'\n    AND l.amount < 100000",
  "SELECT \n    a.account_id, \n    d.a2 AS district_name, \n    d.a3 AS district_region\nFROM \n    financial.account a \nJOIN \n    financial.district d ON a.district_id = d.district_id\nWHERE \n    a.date LIKE '1993%' \n    AND EXISTS (\n        SELECT 1\n        FROM financial.trans t\n        WHERE t.account_id = a.account_id\n        AND t.date < t.operation_date\n    )\nORDER BY \n    a.account_id",
  "",
  "SELECT \n    a.account_id, \n    a.date \nFROM \n    account a \nJOIN \n    district d ON a.district_id = d.district_id \nWHERE \n    d.a2 = 'Prachatice'",
  "",
  "SELECT \n    a.account_id,\n    d.a3 AS region,\n    d.a2 AS district\nFROM \n    financial.account a\nJOIN \n    financial.disp d ON a.account_id = d.account_id\nJOIN \n    financial.client c ON d.client_id = c.client_id\nJOIN \n    financial.district district ON c.district_id = district.district_id\nJOIN \n    financial.loan l ON a.account_id = l.account_id\nWHERE \n    l.amount > 300000\nORDER BY \n    a.account_id",
  "SELECT \n  l.loan_id,\n  d.a11 AS average_salary,\n  d.a3 AS region\nFROM \n  loan l\n  JOIN account a ON l.account_id = a.account_id\n  JOIN client c ON a.client_id = c.client_id\n  JOIN district d ON c.district_id = d.district_id\nWHERE \n  l.duration = 60",
  "SELECT \n    d.district_id AS district, \n    ((d.a13 - d.a12) / d.a12) * 100 AS unemployment_rate_increment\nFROM \n    district d\nWHERE \n    d.a12 IS NOT NULL AND d.a13 IS NOT NULL\nORDER BY \n    unemployment_rate_increment DESC",
  "SELECT \n  (COUNT(DISTINCT a.account_id) / (SELECT COUNT(*) FROM account WHERE date LIKE '1993%')) * 100 AS percentage\nFROM \n  account a\n  JOIN district d ON a.district_id = d.district_id\nWHERE \n  d.a2 = 'Decin' AND a.date LIKE '1993%'",
  "SELECT \n    a.account_id\nFROM \n    account a\n    JOIN disp d ON a.account_id = d.account_id\n    JOIN client c ON d.client_id = c.client_id\n    JOIN district d2 ON c.district_id = d2.district_id\nWHERE \n    d.type = 'POPLATEK MESICNE'\n    AND a.frequency = 'MONTHLY'",
  "SELECT \n  d.a2, \n  COUNT(c.client_id) AS female_count\nFROM \n  client c\n  JOIN district d ON c.district_id = d.district_id\nWHERE \n  c.gender = 'F'\nGROUP BY \n  d.a2\nORDER BY \n  female_count DESC\nLIMIT 9",
  "SELECT \n    d.a2 AS district_name, \n    SUM(t.amount) AS total_withdrawals\nFROM \n    trans t\nJOIN \n    account a ON t.account_id = a.account_id\nJOIN \n    client c ON a.client_id = c.client_id\nJOIN \n    district d ON c.district_id = d.district_id\nWHERE \n    t.type = 'VYDAJ' \n    AND t.date LIKE '1996-01%'\nGROUP BY \n    d.a2\nORDER BY \n    total_withdrawals DESC\nLIMIT 10",
  "SELECT COUNT(*)\nFROM \n    account \nJOIN client ON account.client_id = client.client_id\nJOIN district ON client.district_id = district.district_id\nWHERE district.a3 LIKE '%South Bohemia%' \nAND account.card_id IS NULL",
  "",
  "SELECT AVG(l.amount) \nFROM loan l \nJOIN account a ON l.account_id = a.account_id \nJOIN client c ON a.client_id = c.client_id \nWHERE c.gender = 'M'",
  "",
  "SELECT COUNT(DISTINCT a.account_id)\nFROM account a\nJOIN client c ON a.district_id = c.district_id\nJOIN district d ON c.district_id = d.district_id\nWHERE d.a16 = (SELECT MAX(d.a16) FROM district d)",
  "SELECT \n    COUNT(DISTINCT a.account_id) \nFROM \n    financial.account a \nJOIN \n    financial.trans t \nON \n    a.account_id = t.account_id \nWHERE \n    a.frequency = 'POPLATEK MESICNE' \n    AND t.type = 'VYBER KARTOU' \n    AND t.balance < 0",
  "SELECT \n  COUNT(DISTINCT a.account_id) \nFROM \n  account a \n  JOIN loan l ON a.account_id = l.account_id \n  JOIN client c ON a.district_id = c.district_id \n  JOIN disp d ON c.client_id = d.client_id \nWHERE \n  a.frequency = 'POPLATEK MESICNE' \n  AND l.date BETWEEN '1995-01-01' AND '1997-12-31' \n  AND l.amount >= 250000 \n  AND l.status = 'APPROVED'",
  "SELECT COUNT(DISTINCT a.account_id)\nFROM financial.account a\nJOIN financial.disp d ON a.account_id = d.account_id\nJOIN financial.client c ON d.client_id = c.client_id\nJOIN financial.district district ON c.district_id = district.district_id\nWHERE a.frequency = 'M' \nAND a.date >= '2010-01-01' \nAND a.date <= '2019-12-31' \nAND district.a2 = '1' \nAND a.status = 'C'",
  "SELECT \n  COUNT(client.client_id) \nFROM \n  client \nWHERE \n  client.district_id IN (\n    SELECT \n      district.district_id \n    FROM \n      district \n    WHERE \n      a15 = (SELECT \n               MAX(a15) \n             FROM \n               district \n             WHERE \n               a15 < (SELECT \n                       MAX(a15) \n                     FROM \n                       district \n                     WHERE \n                       a15 IS NOT NULL \n                     LIMIT 1) \n             LIMIT 1) \n  ) \nAND \n  client.gender = 'M'",
  "SELECT COUNT(*)\nFROM card\nWHERE type = 'gold' AND disp_id IN (\n  SELECT disp_id\n  FROM disp\n  WHERE type = 'OWNER'\n)",
  "SELECT COUNT(DISTINCT account.account_id)\nFROM account\nJOIN client ON account.district_id = client.district_id\nWHERE client.district_id IN (SELECT district.district_id FROM district WHERE a2 = 'Pisek')",
  "SELECT \n    d.a2 AS district_name,\n    SUM(t.amount) AS total_transactions\nFROM \n    trans t\nJOIN \n    account a ON t.account_id = a.account_id\nJOIN \n    client c ON a.client_id = c.client_id\nJOIN \n    district d ON c.district_id = d.district_id\nWHERE \n    t.date BETWEEN '1997-01-01' AND '1997-12-31'\n    AND t.amount > 10000\nGROUP BY \n    d.a2\nHAVING \n    SUM(t.amount) > 10000\nORDER BY \n    total_transactions DESC",
  "",
  "SELECT \n  a.account_id, \n  a.frequency, \n  a.date, \n  c.type, \n  c.issued\nFROM \n  account a, \n  disp d, \n  card c\nWHERE \n  a.account_id = d.account_id \n  AND d.disp_id = c.disp_id \n  AND c.type = 'Gold'",
  "SELECT \n  AVG(t.amount) AS average_credit_card_withdrawal\nFROM \n  trans t\nWHERE \n  t.operation = 'VYBER KARTOU'\n  AND t.date BETWEEN '2021-01-01' AND '2021-12-31'\n  AND t.account_id IN (\n    SELECT \n      a.account_id\n    FROM \n      account a\n      JOIN client c ON a.district_id = c.district_id\n    WHERE \n      c.birth_date BETWEEN '2001-01-01' AND '2001-12-31'\n  )",
  "SELECT \n    a.account_id\nFROM \n    trans t\nJOIN \n    account a ON t.account_id = a.account_id\nJOIN \n    client c ON a.client_id = c.client_id\nWHERE \n    t.date >= '1998-01-01' AND t.date <= '1998-12-31' \n    AND t.type = 'VYBER KARTOU' \n    AND t.amount < (SELECT AVG(t2.amount) \n                     FROM trans t2 \n                     WHERE t2.date >= '1998-01-01' AND t2.date <= '1998-12-31' \n                     AND t2.type = 'VYBER KARTOU')",
  "SELECT \n    c.client_id, \n    c.gender, \n    c.birth_date, \n    a.account_id, \n    c.district_id, \n    d.district_id\nFROM \n    client c \nJOIN \n    disp d ON c.client_id = d.client_id \nJOIN \n    account a ON d.account_id = a.account_id \nWHERE \n    c.gender = 'F' \n    AND EXISTS (SELECT 1 FROM card WHERE d.disp_id = card.disp_id) \n    AND EXISTS (SELECT 1 FROM loan WHERE a.account_id = loan.account_id)",
  "SELECT COUNT(DISTINCT c.client_id)\nFROM client c\nJOIN account a ON c.client_id = a.account_id\nJOIN district d ON c.district_id = d.district_id\nWHERE c.gender = 'F' AND d.a3 LIKE '%South Bohemia%'",
  "SELECT \n    a.account_id, \n    a.district_id, \n    a.frequency\nFROM \n    account a \nJOIN \n    client c ON a.account_id = c.client_id \nJOIN \n    district d ON c.district_id = d.district_id \nWHERE \n    d.a2 = 'Tabor' \n    AND a.frequency = 'OWNER'",
  "SELECT \n  a.type \nFROM \n  account a \n  JOIN client c ON a.district_id = c.district_id \n  JOIN district d ON c.district_id = d.district_id \nWHERE \n  a.type!= 'OWNER' \n  AND d.a11 > 8000 \n  AND d.a11 <= 9000",
  "SELECT COUNT(DISTINCT a.account_id)\nFROM financial.account a\nJOIN financial.trans t ON a.account_id = t.account_id\nJOIN financial.client c ON a.district_id = c.district_id\nJOIN financial.district d ON c.district_id = d.district_id\nWHERE d.a3 LIKE '%North Bohemia%' AND t.bank = 'AB'",
  "SELECT \n  d.a2 AS district_name\nFROM \n  account a \n  JOIN district d ON a.district_id = d.district_id \n  JOIN trans t ON a.account_id = t.account_id\nWHERE \n  t.type = 'VYDAJ'\nGROUP BY \n  d.a2",
  "SELECT \n    AVG(a15) AS avg_crimes\nFROM \n    district\nWHERE \n    a3 IN (SELECT \n              d.a3\n             FROM \n              district d\n             JOIN \n              account a ON d.district_id = a.district_id\n             WHERE \n              a.date >= '1997-01-01' AND a.date < '2000-01-01' AND a.frequency = 'yearly'\n             GROUP BY \n              d.a3\n             HAVING \n              COUNT(a.account_id) > 4000)",
  "SELECT COUNT(DISTINCT c.card_id)\nFROM financial.card c\nJOIN financial.disp d ON c.disp_id = d.disp_id\nJOIN financial.account a ON d.account_id = a.account_id\nWHERE c.type = 'CLASSIC' AND a.frequency = 'OWNER'",
  "SELECT \n    COUNT(*) \nFROM \n    client \nWHERE \n    gender = 'M' \n    AND district_id IN (\n        SELECT \n            district_id \n        FROM \n            district \n        WHERE \n            a2 = 'Hl.m. Praha'\n    )",
  "SELECT \n  (COUNT(CASE WHEN c.type = 'gold' AND c.issued < '1998-01-01' THEN 1 END) / \n   (SELECT COUNT(*) FROM card c2)) * 100 AS percent_gold\nFROM \n  card c\nWHERE \n  c.type = 'gold'",
  "SELECT c.client_id, c.gender, c.birth_date, c.district_id\nFROM client c\nJOIN account a ON c.client_id = a.client_id\nJOIN loan l ON a.account_id = l.account_id\nWHERE l.amount = (SELECT MAX(amount) FROM loan)",
  "SELECT d.a15 AS num_crimes\nFROM account a\nJOIN district d ON a.district_id = d.district_id\nWHERE a.account_id = 532",
  "SELECT d.district_id\nFROM account a\nJOIN order o ON a.account_id = o.account_id\nJOIN district d ON a.district_id = d.district_id\nWHERE o.order_id = 33333",
  "SELECT \n  t.trans_id, \n  t.date, \n  t.operation, \n  t.amount, \n  t.balance, \n  t.k_symbol, \n  t.bank, \n  t.account\nFROM \n  trans t\n  INNER JOIN account a ON t.account = a.account_id\n  INNER JOIN client c ON a.client_id = c.client_id\nWHERE \n  c.client_id = 3356 \n  AND t.operation = 'VYBER'",
  "SELECT COUNT(*)\nFROM account\nJOIN disp ON account.account_id = disp.account_id\nJOIN loan ON account.account_id = loan.account_id\nWHERE account.frequency = 'POPLATEK TYDNE'\nAND loan.amount < 200000",
  "SELECT \n  ca.type \nFROM \n  client c \n  JOIN disp d ON c.client_id = d.client_id \n  JOIN card ca ON d.disp_id = ca.disp_id \nWHERE \n  c.client_id = 13539",
  "SELECT \n    d.a3 AS region \nFROM \n    client c \nJOIN \n    district d ON c.district_id = d.district_id \nWHERE \n    c.client_id = 3541",
  "SELECT d.a2 AS district\nFROM (\n  SELECT a.district_id, COUNT(*) AS count\n  FROM account a\n  JOIN loan l ON a.account_id = l.account_id\n  WHERE l.status = 'A'\n  GROUP BY a.district_id\n) AS subquery\nJOIN district d ON subquery.district_id = d.district_id\nORDER BY count DESC\nLIMIT 1",
  "SELECT c.client_name\nFROM client c\nJOIN disp d ON c.client_id = d.client_id\nJOIN account a ON d.account_id = a.account_id\nJOIN order o ON a.account_id = o.account_id\nWHERE o.order_id = 32423",
  "SELECT \n  t.trans_id, \n  t.date, \n  t.type, \n  t.operation, \n  t.amount, \n  t.balance, \n  t.k_symbol, \n  t.bank, \n  t.account\nFROM \n  trans t\n  JOIN account a ON t.account_id = a.account_id\n  JOIN district d ON a.district_id = d.district_id\nWHERE \n  d.district_id = 5\nORDER BY \n  t.date",
  "SELECT COUNT(*)\nFROM account\nWHERE district_id IN (\n  SELECT district_id\n  FROM district\n  WHERE a2 = 'Jesenik'\n)",
  "SELECT \n  c.client_id\nFROM \n  client c \n  INNER JOIN disp d ON c.client_id = d.client_id \n  INNER JOIN card ca ON d.disp_id = ca.disp_id \nWHERE \n  ca.type = 'junior' \n  AND ca.issued > '1996-01-01'",
  "",
  "SELECT \n    (SUM(CASE WHEN EXTRACT(YEAR FROM t.date) = 1997 THEN t.amount ELSE 0 END) \n     - SUM(CASE WHEN EXTRACT(YEAR FROM t.date) = 1996 THEN t.amount ELSE 0 END)) \n     / SUM(CASE WHEN EXTRACT(YEAR FROM t.date) = 1996 THEN t.amount ELSE 0 END) * 100\nFROM \n    loan t\nJOIN \n    client c ON t.account_id = c.client_id\nWHERE \n    c.gender = 'M'",
  "SELECT COUNT(*)\nFROM trans\nWHERE operation = 'VYBER KARTOU'\nAND DATE(trans.date) > '1995-12-31'",
  "SELECT \n  (SELECT COUNT(*) FROM account a \n   WHERE a.date = '1996-01-01' AND a.district_id IN \n     (SELECT district_id FROM district WHERE a3 = 'North Bohemia')) \n  - \n  (SELECT COUNT(*) FROM account a \n   WHERE a.date = '1996-01-01' AND a.district_id IN \n     (SELECT district_id FROM district WHERE a3 = 'East Bohemia'))",
  "SELECT \n  COUNT(DISTINCT d.disp_id) AS owner_dispositions, \n  COUNT(DISTINCT c.disp_id) AS disponent_dispositions\nFROM \n  account a \n  JOIN disp d ON a.account_id = d.account_id \n  LEFT JOIN disp c ON d.disp_id = c.disp_id \nWHERE \n  a.account_id BETWEEN 1 AND 10\nGROUP BY \n  a.account_id",
  "SELECT \n    COUNT(DISTINCT a.date) AS frequency,\n    SUM(CASE WHEN t.k_symbol = '3539' THEN t.amount ELSE 0 END) AS total_debit\nFROM \n    account a \nJOIN \n    trans t ON a.account_id = t.account_id\nWHERE \n    a.account_id = 3 \n    AND a.frequency ='monthly'\nORDER BY \n    a.date",
  "SELECT \n  client.birth_date \nFROM \n  client \n  JOIN disp ON client.client_id = disp.client_id \nWHERE \n  client.client_id = 130",
  "SELECT COUNT(DISTINCT a.account_id)\nFROM account a\nJOIN client c ON a.district_id = c.district_id\nJOIN disp d ON c.client_id = d.client_id AND a.account_id = d.account_id\nWHERE c.gender = 'M' AND a.frequency = 'POPLATEK PO OBRATU'",
  "SELECT \n    SUM(l.amount) AS total_debt,\n    SUM(l.payments) AS total_payments,\n    SUM(l.amount) - SUM(l.payments) AS remaining_debt\nFROM \n    loan l\nJOIN \n    account a ON l.account_id = a.account_id\nWHERE \n    a.client_id = 992",
  "",
  "SELECT \n    ca.type \nFROM \n    client c \nJOIN \n    disp d ON c.client_id = d.client_id \nJOIN \n    card ca ON d.disp_id = ca.disp_id \nWHERE \n    c.client_id = 9",
  "SELECT SUM(amount) AS total_paid\nFROM trans\nWHERE account_id IN (\n  SELECT account_id\n  FROM client\n  WHERE client_id = 617\n) AND \n  EXTRACT(YEAR FROM date) = 1998",
  "SELECT c.client_id, c.birth_date\nFROM client c\nJOIN account a ON c.district_id = a.district_id\nJOIN district d ON a.district_id = d.district_id\nWHERE c.birth_date BETWEEN '1983-01-01' AND '1987-12-12'\nAND d.a2 = 'East Bohemia'",
  "SELECT \n    c.client_id\nFROM \n    client c\nJOIN \n    account a ON c.district_id = a.district_id\nJOIN \n    loan l ON a.account_id = l.account_id\nWHERE \n    c.gender = 'F'\nORDER BY \n    l.amount DESC\nLIMIT 3",
  "SELECT COUNT(*)\nFROM client c\nJOIN disp d ON c.client_id = d.client_id\nJOIN account a ON d.account_id = a.account_id\nJOIN loan l ON a.account_id = l.account_id\nWHERE c.gender = 'M'\nAND c.birth_date BETWEEN '1974-01-01' AND '1976-12-31'\nAND l.status = 'P'\nAND l.amount > 4000",
  "SELECT COUNT(DISTINCT a.account_id)\nFROM financial.account a\nJOIN financial.client c ON a.client_id = c.client_id\nJOIN financial.district d ON c.district_id = d.district_id\nWHERE d.a2 = 'Beroun' AND a.date > '1996-01-01'",
  "SELECT COUNT(*)\nFROM client\nJOIN disp ON client.client_id = disp.client_id\nJOIN card ON disp.disp_id = card.disp_id\nWHERE client.gender = 'F' AND card.type = 'J'",
  "SELECT \n    (COUNT(CASE WHEN client.gender = 'F' AND district.a2 = 'Prague' THEN 1 ELSE NULL END) \n    / COUNT(DISTINCT client.client_id)) * 100 AS percentage_female\nFROM \n    client \nJOIN \n    account ON client.client_id = account.account_id \nJOIN \n    district ON account.district_id = district.district_id \nWHERE \n    district.a2 = 'Prague'",
  "SELECT \n    (COUNT(DISTINCT c.client_id) \n    FROM \n        client c \n    JOIN \n        account a ON c.client_id = a.account_id \n    JOIN \n        trans t ON a.account_id = t.account_id \n    WHERE \n        c.gender = 'M' \n        AND t.type = 'POPLATEK TYDNE') \n    / \n    (SELECT \n        COUNT(DISTINCT c.client_id) \n    FROM \n        client c \n    JOIN \n        account a ON c.client_id = a.account_id \n    JOIN \n        trans t ON a.account_id = t.account_id \n    WHERE \n        t.type = 'POPLATEK TYDNE')",
  "SELECT COUNT(*)\nFROM client\nWHERE gender = 'Owner' AND client_id IN (\n  SELECT client_id\n  FROM disp\n  WHERE disp_id IN (\n    SELECT disp_id\n    FROM card\n    WHERE type = 'POPLATEK TYDNE'\n  )\n)",
  "SELECT \n    a.account_id, \n    a.frequency, \n    a.date, \n    l.amount, \n    l.duration\nFROM \n    account a \nJOIN \n    loan l ON a.account_id = l.account_id\nWHERE \n    l.duration > 24 AND a.date < '1997-01-01'\nORDER BY \n    l.amount\nLIMIT 1",
  "SELECT \n    a.account_id\nFROM \n    account a\n    JOIN client c ON a.account_id = c.client_id\n    JOIN district d ON c.district_id = d.district_id\nWHERE \n    c.gender = 'F'\n    AND d.a11 = (SELECT MIN(a11) FROM district)\nORDER BY \n    a.account_id\nLIMIT 1",
  "SELECT COUNT(*)\nFROM client\nWHERE birth_date LIKE '1920%' \nAND district_id IN (\n  SELECT district_id\n  FROM district\n  WHERE a3 LIKE '%East Bohemia%'\n)",
  "SELECT COUNT(DISTINCT a.account_id)\nFROM account a\nJOIN loan l ON a.account_id = l.account_id\nWHERE a.frequency = 'POPLATEK TYDNE'\nAND l.duration = 24",
  "SELECT AVG(amount) \nFROM loan \nWHERE status = 'C' \nAND EXISTS (\n  SELECT 1 \n  FROM trans \n  WHERE trans.account_id = loan.account_id \n  AND trans.type = 'POPLATEK PO OBRATU'\n)",
  "SELECT c.client_id, d.a2\nFROM client c\nJOIN district d ON c.district_id = d.district_id\nWHERE (c.client_id, c.district_id) NOT IN (\n    SELECT a.account_id, a.district_id\n    FROM account a\n    JOIN disp d ON a.account_id = d.account_id\n    WHERE d.type = 'owner'\n)\nAND (c.client_id, c.district_id) NOT IN (\n    SELECT l.account_id, l.district_id\n    FROM loan l\n    WHERE l.status = 'active'\n)",
  "SELECT \n    c.client_id, \n    TIMESTAMPDIFF(YEAR, c.birth_date, CURDATE()) AS age\nFROM \n    financial.client c\nJOIN \n    financial.disp d ON c.client_id = d.client_id\nJOIN \n    financial.card ca ON d.disp_id = ca.disp_id\nWHERE \n    ca.type = 'gold' \n    AND d.type = 'OWNER'",
  "SELECT \n  bond_type, \n  COUNT(*) AS count\nFROM \n  bond\nGROUP BY \n  bond_type\nORDER BY \n  count DESC\nLIMIT 1",
  "SELECT COUNT(*)\nFROM molecule\nJOIN atom ON molecule.molecule_id = atom.molecule_id\nWHERE molecule.label = '-'\nAND atom.element = 'cl'",
  "SELECT AVG(CASE WHEN a.element = 'o' THEN 1 ELSE 0 END) AS avg_oxygen\nFROM \n  connected c \n  JOIN atom a ON c.atom_id = a.atom_id \nWHERE c.atom_id2 IS NULL\n  AND a.element = 'o'\nGROUP BY a.molecule_id",
  "SELECT \n  AVG(CASE \n    WHEN b.bond_type = '-' THEN 1 \n    ELSE 0 \n  END) \nFROM \n  molecule m \n  JOIN connected c ON m.molecule_id = c.molecule_id \n  JOIN bond b ON c.bond_id = b.bond_id \nWHERE \n  m.label = '+'",
  "SELECT COUNT(*) \nFROM molecule \nWHERE label = '-'\nAND molecule_id IN (\n  SELECT molecule_id \n  FROM atom \n  WHERE element = 'na'\n  GROUP BY molecule_id\n)",
  "SELECT m.label\nFROM molecule m\nJOIN atom a ON m.molecule_id = a.molecule_id\nJOIN bond b ON a.molecule_id = b.molecule_id\nJOIN connected c ON a.atom_id = c.atom_id AND a.atom_id = c.atom_id2 AND b.bond_id = c.bond_id\nWHERE b.bond_type = '#' AND m.label = '+'",
  "SELECT \n  DIVIDE(\n    SUM(CASE WHEN a.element = 'c' THEN 1 ELSE 0 END), \n    (SELECT COUNT(*) FROM atom) \n  ) * 100 AS percentage\nFROM \n  atom a\n  JOIN connected c ON a.atom_id = c.atom_id1\n  JOIN bond b ON c.bond_id = b.bond_id\n  JOIN molecule m ON a.molecule_id = m.molecule_id\nWHERE \n  b.bond_type = '='",
  "SELECT COUNT(*)\nFROM bond\nWHERE bond_type = '#'",
  "SELECT COUNT(*)\nFROM atom\nWHERE element!= 'Br'",
  "SELECT COUNT(*)\nFROM molecule m\nWHERE m.label = '+' AND m.molecule_id BETWEEN 'TR000' AND 'TR099'",
  "SELECT m.molecule_id\nFROM molecule m\nWHERE m.label IN (\n  SELECT a.molecule_id\n  FROM atom a\n  WHERE a.element = 'c'\n)",
  "SELECT DISTINCT a.element\nFROM connected c\nJOIN atom a ON c.atom_id = a.atom_id\nWHERE c.atom_id2 IN (\n  SELECT connected.atom_id2\n  FROM connected\n  JOIN bond b ON connected.bond_id = b.bond_id\n  WHERE b.bond_id = 'TR004_8_9'\n)",
  "SELECT DISTINCT a1.element, a2.element\nFROM connected c\nJOIN bond b ON c.bond_id = b.bond_id\nJOIN atom a1 ON c.atom_id = a1.atom_id\nJOIN atom a2 ON c.atom_id2 = a2.atom_id\nWHERE b.bond_type = '='",
  "SELECT \n    m.label, \n    COUNT(a.element) as count\nFROM \n    atom a \n    JOIN molecule m ON a.molecule_id = m.molecule_id\nWHERE \n    a.element = 'h'\nGROUP BY \n    m.label\nORDER BY \n    count DESC\nLIMIT 1",
  "SELECT \n  bond_type\nFROM \n  bond\nWHERE \n  (SELECT \n     element \n   FROM \n     atom \n   WHERE \n     atom.molecule_id = bond.molecule_id \n   AND \n     element = 'cl') IS NOT NULL",
  "SELECT \n  a1.element, \n  a2.element\nFROM \n  connected c\n  JOIN atom a1 ON c.atom_id = a1.atom_id\n  JOIN atom a2 ON c.atom_id2 = a2.atom_id\n  JOIN bond b ON c.bond_id = b.bond_id\nWHERE \n  b.bond_type = '-'",
  "SELECT DISTINCT a1.element AS element1, a2.element AS element2\nFROM connected c\nJOIN atom a1 ON c.atom_id = a1.atom_id\nJOIN atom a2 ON c.atom_id2 = a2.atom_id\nJOIN molecule m ON a1.molecule_id = m.molecule_id AND m.label = '-'\nWHERE a1.molecule_id = a2.molecule_id",
  "SELECT \n  element\nFROM \n  atom\nWHERE \n  molecule_id IN (\n    SELECT \n      molecule_id\n    FROM \n      molecule\n    WHERE \n      label = '-'\n  )\nGROUP BY \n  element\nORDER BY \n  COUNT(element) ASC\nLIMIT 1",
  "SELECT \n  b.bond_type \nFROM \n  connected c \n  JOIN bond b ON c.bond_id = b.bond_id \nWHERE \n  (c.atom_id = 'TR004_8' AND c.atom_id2 = 'TR004_20') \n  OR (c.atom_id = 'TR004_20' AND c.atom_id2 = 'TR004_8')",
  "SELECT \n  m.label\nFROM \n  molecule m\nWHERE \n  NOT EXISTS (\n    SELECT \n      1\n    FROM \n      atom a\n      JOIN connected c ON a.atom_id = c.atom_id\n      JOIN atom a2 ON c.atom_id2 = a2.atom_id\n      JOIN bond b ON c.bond_id = b.bond_id\n      JOIN atom b_a ON b.atom_id = b_a.atom_id\n      WHERE \n        a.element = 'Sn' AND a2.element = 'Sn' \n        AND m.molecule_id = a.molecule_id\n  )",
  "SELECT \n  COUNT(DISTINCT a.atom_id)\nFROM \n  atom a\n  JOIN molecule m ON a.molecule_id = m.molecule_id\n  JOIN bond b ON a.molecule_id = b.molecule_id\n  JOIN connected c ON a.atom_id = c.atom_id\n  JOIN connected c2 ON a.atom_id = c2.atom_id2\nWHERE \n  a.element IN ('i','s') AND \n  b.bond_type = '-' AND \n  c.bond_id = c2.bond_id",
  "SELECT \n  a1.element AS element1, \n  a2.element AS element2, \n  b.bond_type AS bond_type\nFROM \n  connected c \n  JOIN atom a1 ON c.atom_id = a1.atom_id \n  JOIN atom a2 ON c.atom_id2 = a2.atom_id \n  JOIN bond b ON c.bond_id = b.bond_id\nWHERE \n  b.bond_type = '#'",
  "SELECT a1.element\nFROM connected c\nJOIN atom a1 ON c.atom_id = a1.atom_id\nJOIN atom a2 ON c.atom_id2 = a2.atom_id\nJOIN molecule m ON a1.molecule_id = m.molecule_id\nWHERE m.label = 'TR181'",
  "",
  "SELECT \n    DIVIDE(\n        SUM(CASE WHEN b.bond_type = '#' THEN 1 ELSE 0 END) * 100, \n        COUNT(b.bond_id)\n    ) as percent\nFROM \n    molecule m\nJOIN \n    bond b ON m.molecule_id = b.molecule_id\nJOIN \n    connected c ON b.bond_id = c.bond_id\nJOIN \n    atom a ON c.atom_id = a.atom_id\nJOIN \n    atom a2 ON c.atom_id2 = a2.atom_id\nWHERE \n    m.label = '+' AND a.element = a2.element",
  "SELECT element\nFROM atom\nWHERE molecule_id = (SELECT molecule_id FROM molecule WHERE label = 'TR000')\nORDER BY element ASC\nLIMIT 3",
  "SELECT a1.element, a2.element\nFROM connected c\nJOIN atom a1 ON c.atom_id = a1.atom_id\nJOIN atom a2 ON c.atom_id2 = a2.atom_id\nWHERE c.bond_id = 'TR001_2_6'\nAND a1.molecule_id = (SELECT molecule_id FROM molecule WHERE label = 'TR001')",
  "SELECT \n    SUM(CASE WHEN m.label = '+' THEN 1 ELSE 0 END) \n    - SUM(CASE WHEN m.label = '-' THEN 1 ELSE 0 END) \nAS difference\nFROM \n    molecule m",
  "SELECT a.atom_id\nFROM connected c\nJOIN atom a ON c.atom_id = a.atom_id\nJOIN bond b ON c.bond_id = b.bond_id\nWHERE b.bond_id = 'TR000_2_5'",
  "SELECT bond_id\nFROM connected\nWHERE atom_id2 = (SELECT atom_id FROM atom WHERE atom_id = 'TR000_2')",
  "SELECT m.label\nFROM molecule m\nJOIN bond b ON m.molecule_id = b.molecule_id\nWHERE b.bond_type ='= '\nORDER BY m.label\nLIMIT 5",
  "SELECT \n    ROUND(\n        (\n            SUM(CASE WHEN bond_type = '=' THEN 1 ELSE 0 END) \n            / \n            COUNT(bond_id)\n        ) * 100, 5\n    ) as percent\nFROM \n    bond \nINNER JOIN \n    connected \nON \n    bond.molecule_id = connected.molecule_id\nWHERE \n    connected.atom_id = connected.atom_id2 \n    AND \n    connected.bond_id IS NOT NULL\n    AND \n    bond.molecule_id = 'TR008'",
  "SELECT \n    ROUND(DIVIDE(SUM(CASE WHEN m.label = '+' THEN 1 ELSE 0 END), COUNT(m.molecule_id)) * 100, 3) AS percent\nFROM \n    molecule m",
  "SELECT \n  ROUND(DIVIDE(SUM(CASE WHEN a.element = 'h' THEN 1 ELSE 0 END), COUNT(a.atom_id)) * 100, 4) AS percent\nFROM \n  atom a \nWHERE \n  a.molecule_id = 'TR206'",
  "SELECT \n  b.bond_type \nFROM \n  connected c \n  JOIN bond b ON c.bond_id = b.bond_id \nWHERE \n  c.atom_id IN (SELECT atom_id FROM atom WHERE molecule_id = (SELECT molecule_id FROM molecule WHERE label = 'TR000'))",
  "SELECT \n  a.element, \n  m.label\nFROM \n  atom a\n  JOIN molecule m ON a.molecule_id = m.molecule_id\nWHERE \n  a.molecule_id = (SELECT molecule_id FROM molecule WHERE label = 'TR060')",
  "SELECT \n  b.bond_type, \n  COUNT(*) AS majority_bond_count, \n  (SELECT COUNT(*) FROM connected WHERE connected.atom_id = a.atom_id OR connected.atom_id2 = a.atom_id AND connected.molecule_id = 'TR010') AS total_bond_count\nFROM \n  bond b\n  JOIN atom a ON b.molecule_id = a.molecule_id\nWHERE \n  b.molecule_id = 'TR010'\nGROUP BY \n  b.bond_type\nORDER BY \n  majority_bond_count DESC\nLIMIT 1",
  "SELECT m.label\nFROM molecule m\nJOIN connected c ON m.molecule_id = c.molecule_id\nJOIN bond b ON c.bond_id = b.bond_id\nWHERE b.bond_type = '-' AND m.label!= '-'\nORDER BY m.label\nLIMIT 3",
  "SELECT \n  b.bond_type\nFROM \n  bond b\nWHERE \n  b.molecule_id = (SELECT molecule_id FROM molecule WHERE label = 'TR006')\nORDER BY \n  b.bond_type\nLIMIT 2",
  "SELECT COUNT(DISTINCT b.bond_id)\nFROM connected c\nJOIN bond b ON c.bond_id = b.bond_id\nWHERE c.atom_id = 'TR009_12' OR c.atom_id2 = 'TR009_12'\nAND c.molecule_id = (SELECT molecule_id FROM molecule WHERE label = 'TR009')",
  "SELECT COUNT(molecule.molecule_id)\nFROM molecule\nJOIN atom ON molecule.molecule_id = atom.molecule_id\nWHERE molecule.label = '+' AND atom.element = 'br'",
  "SELECT \n  b.bond_type,\n  c.atom_id, c.atom_id2\nFROM \n  bond b\n  JOIN connected c ON b.bond_id = c.bond_id\nWHERE \n  b.molecule_id IN (\n    SELECT \n      m.molecule_id\n    FROM \n      molecule m\n    WHERE \n      m.label = 'TR001_6_9'\n  )",
  "SELECT \n  m.label,\n  CASE \n    WHEN m.label = '+' THEN 'carcinogenic'\n    ELSE 'not carcinogenic'\n  END AS carcinogenic_status\nFROM \n  atom a\n  JOIN molecule m ON a.molecule_id = m.molecule_id\nWHERE \n  a.atom_id = 'TR001_10'",
  "SELECT COUNT(DISTINCT m.molecule_id)\nFROM molecule m\nJOIN bond b ON m.molecule_id = b.molecule_id\nWHERE b.bond_type = '#'",
  "SELECT COUNT(*) \nFROM connected \nWHERE atom_id = 'TR%_19' OR atom_id2 = 'TR%_19'",
  "SELECT DISTINCT a.element\nFROM atom a\nJOIN molecule m ON a.molecule_id = m.molecule_id\nWHERE m.molecule_id = 'TR004'",
  "SELECT COUNT(*)\nFROM molecule\nWHERE label = '-'",
  "SELECT \n  m.label\nFROM \n  molecule m\n  JOIN connected c ON m.molecule_id = c.molecule_id\nWHERE \n  EXISTS (\n    SELECT 1\n    FROM \n      atom a \n      JOIN connected c2 ON a.atom_id = c2.atom_id\n    WHERE \n      a.atom_id BETWEEN 21 AND 25 \n      AND c2.molecule_id = m.molecule_id\n  )\n  AND m.label = '+'",
  "SELECT \n  b.bond_id, \n  a1.element AS element1, \n  a2.element AS element2 \nFROM \n  bond b \n  JOIN connected c ON b.bond_id = c.bond_id \n  JOIN atom a1 ON c.atom_id = a1.atom_id \n  JOIN atom a2 ON c.atom_id2 = a2.atom_id \nWHERE \n  a1.element = 'p' AND a2.element = 'n'",
  "SELECT m.label\nFROM molecule m\nJOIN (\n  SELECT molecule_id, COUNT(*) AS num_double_bonds\n  FROM bond\n  WHERE bond_type = '='\n  GROUP BY molecule_id\n  ORDER BY num_double_bonds DESC\n  LIMIT 1\n) AS double_bonds ON m.molecule_id = double_bonds.molecule_id\nWHERE m.label = '+'",
  "SELECT \n  AVG(COUNT(bond_id)) AS average_bonds\nFROM \n  atom a\n  JOIN connected c ON a.atom_id = c.atom_id1\n  JOIN bond b ON c.bond_id = b.bond_id\nWHERE \n  a.element = 'i'",
  "SELECT \n  bond_type, \n  bond_id \nFROM \n  bond \nWHERE \n  molecule_id IN (\n    SELECT \n      molecule_id \n    FROM \n      connected \n    WHERE \n      atom_id = 45 OR atom_id2 = 45\n  )",
  "SELECT DISTINCT \n    a.element\nFROM \n    atom a\nWHERE \n    a.atom_id NOT IN \n    (\n        SELECT \n            c.atom_id\n        FROM \n            connected c\n    )\n    AND a.atom_id NOT IN \n    (\n        SELECT \n            c.atom_id2\n        FROM \n            connected c\n    )",
  "SELECT a.element\nFROM connected c\nJOIN bond b ON c.bond_id = b.bond_id\nJOIN atom a ON c.atom_id = a.atom_id\nJOIN atom a2 ON c.atom_id2 = a2.atom_id\nWHERE b.bond_type = '#' AND a.molecule_id = (SELECT molecule_id FROM molecule WHERE label = 'TR041')",
  "SELECT \n    a.element\nFROM \n    connected c\nJOIN \n    bond b ON c.bond_id = b.bond_id\nJOIN \n    atom a ON c.atom_id = a.atom_id\nWHERE \n    b.bond_id = 'TR144_8_19'",
  "SELECT m.label, COUNT(b.bond_type ='= ') AS num_double_bonds\nFROM molecule m\nJOIN atom a ON m.molecule_id = a.molecule_id\nJOIN connected c ON a.atom_id = c.atom_id1\nJOIN bond b ON c.bond_id = b.bond_id\nWHERE m.label = '+'\nGROUP BY m.label\nORDER BY num_double_bonds DESC\nLIMIT 1",
  "SELECT \n  e.element \nFROM \n  molecule m \n  JOIN atom a ON m.molecule_id = a.molecule_id \n  JOIN connected c ON a.atom_id = c.atom_id \n  JOIN connected c2 ON a.atom_id = c2.atom_id2 \n  JOIN connected c3 ON c.atom_id2 = c3.atom_id \n  JOIN connected c4 ON c2.atom_id2 = c4.atom_id \n  JOIN atom a2 ON c4.atom_id = a2.atom_id \n  JOIN bond b ON c4.bond_id = b.bond_id \n  JOIN atom a3 ON c3.atom_id2 = a3.atom_id \n  JOIN bond b2 ON c3.b",
  "SELECT DISTINCT a1.atom_id FROM atom a1, connected c, atom a2 WHERE a1.element = 'pb' AND c.atom_id = a1.atom_id AND c.atom_id2 = a2.atom_id",
  "SELECT \n    a1.element AS element1,\n    a2.element AS element2\nFROM \n    connected c\nJOIN \n    atom a1 ON c.atom_id = a1.atom_id\nJOIN \n    atom a2 ON c.atom_id2 = a2.atom_id\nJOIN \n    bond bt ON c.bond_id = bt.bond_id\nWHERE \n    bt.bond_type = '#'",
  "SELECT \n  ROUND(\n    (COUNT(*) * 100.0) / \n    (SELECT COUNT(*) FROM bond), \n    2\n  ) AS percentage\nFROM (\n  SELECT \n    bond_id, \n    COUNT(DISTINCT atom.element) AS num_atoms, \n    COUNT(DISTINCT atom_id) AS num_atoms_count\n  FROM \n    bond\n  JOIN \n    atom ON bond.atom_id = atom.atom_id\n  GROUP BY \n    bond_id\n  ORDER BY \n    num_atoms DESC\n  LIMIT 1\n) AS subquery",
  "SELECT \n  ROUND(\n    (SELECT COUNT(*) FROM molecule WHERE label = '+') * 100 / \n    (SELECT COUNT(*) FROM bond WHERE bond_type = '-'), \n  5\n  ) AS proportion",
  "SELECT \n  COUNT(*) \nFROM \n  atom \nWHERE \n  element IN ('C', 'H') \n  AND atom.molecule_id = molecule.molecule_id \nFROM \n  molecule, atom",
  "SELECT c.atom_id2\nFROM connected c\nJOIN atom a ON c.atom_id = a.atom_id\nWHERE a.element ='s'",
  "SELECT \n  b.bond_type \nFROM \n  connected c \nJOIN \n  bond b ON c.bond_id = b.bond_id \nWHERE \n  c.atom_id IN (SELECT atom_id FROM atom WHERE element ='sn')",
  "",
  "SELECT \n  COUNT(DISTINCT a.atom_id) \nFROM \n  atom a \n  JOIN molecule m ON a.molecule_id = m.molecule_id \n  JOIN connected c ON a.atom_id IN (c.atom_id, c.atom_id2) \n  JOIN bond b ON c.bond_id = b.bond_id \nWHERE \n  m.label LIKE '%triple%' \n  AND (a.element = 'p' OR (SELECT element FROM atom WHERE atom_id = c.atom_id2) = 'p') \n  AND (a.element = 'br' OR (SELECT element FROM atom WHERE atom_id = c.atom_id2) = 'br')",
  "SELECT b.bond_id\nFROM molecule m\nJOIN connected c ON m.molecule_id = c.molecule_id\nJOIN bond b ON c.bond_id = b.bond_id\nWHERE m.label = '+'",
  "SELECT m.molecule_id\nFROM molecule m\nJOIN connected c ON m.molecule_id = c.molecule_id\nJOIN bond b ON c.bond_id = b.bond_id\nWHERE b.bond_type = '-' AND m.label <> '-'",
  "SELECT \n  DIVIDE(SUM(CASE WHEN element = 'cl' THEN 1 ELSE 0 END), COUNT(atom_id)) as percent \nFROM \n  atom \n  JOIN connected ON atom.atom_id = connected.atom_id1 \n  JOIN bond ON connected.bond_id = bond.bond_id \n  JOIN molecule ON atom.molecule_id = molecule.molecule_id \nWHERE \n  bond.bond_type = '-'",
  "SELECT m.label\nFROM molecule m\nWHERE m.molecule_id IN ('TR000', 'TR001', 'TR002')",
  "SELECT \n  m.molecule_id\nFROM \n  molecule m\nWHERE \n  m.label = '-'",
  "SELECT COUNT(molecule_id) \nFROM molecule \nWHERE label = '+' \nAND molecule_id BETWEEN 'TR000' AND 'TR030'",
  "SELECT \n  b.bond_type, \n  m.label\nFROM \n  bond b \n  JOIN molecule m ON b.molecule_id = m.molecule_id\nWHERE \n  m.molecule_id BETWEEN 'TR000' AND 'TR050'\nORDER BY \n  m.label",
  "SELECT a.element\nFROM connected c\nJOIN bond b ON c.bond_id = b.bond_id\nJOIN atom a ON c.atom_id = a.atom_id\nWHERE b.bond_id = 'TR001_10_11'",
  "SELECT bond_id\nFROM connected\nWHERE atom_id IN (\n  SELECT atom_id\n  FROM atom\n  WHERE element = 'i'\n)\n```\nThis query first selects all the atom ids that have element 'i'. Then it selects all the bond ids that are connected to these atom ids.",
  "SELECT \n  CASE \n    WHEN MAX(label) = '+' THEN 'Carcinogenic'\n    WHEN MAX(label) = '-' THEN 'Non-Carcinogenic'\n    ELSE 'Unknown'\n  END AS 'Carcinogenic/Non-Carcinogenic'\nFROM \n  molecule\nWHERE \n  EXISTS (SELECT 1 FROM atom WHERE molecule.molecule_id = atom.molecule_id AND element = 'ca')",
  "SELECT \n  *\nFROM \n  bond \nWHERE \n  bond_id = 'TR001_1_8' \n  AND \n  (SELECT \n     element \n   FROM \n     atom \n   WHERE \n     atom.atom_id IN \n       (SELECT \n          atom_id \n        FROM \n          connected \n        WHERE \n          bond_id = 'TR001_1_8')) \n  IN \n  ('cl', 'c')",
  "SELECT \n  m.molecule_id\nFROM \n  molecule m\n  JOIN atom a ON m.molecule_id = a.molecule_id\n  JOIN bond b ON a.molecule_id = b.molecule_id\n  JOIN connected c ON a.atom_id = c.atom_id AND b.bond_id = c.bond_id\nWHERE \n  a.element = 'c' AND b.bond_type = '#' AND m.label = '-'\nLIMIT 2",
  "SELECT \n  DIVIDE(SUM(CASE WHEN a.element = 'cl' THEN 1 ELSE 0 END), COUNT(DISTINCT a.molecule_id)) \n  AS percentage \nFROM \n  atom a \n  JOIN molecule m ON a.molecule_id = m.molecule_id \nWHERE \n  m.label = '+'",
  "SELECT \n  a.element \nFROM \n  atom a \n  JOIN molecule m ON a.molecule_id = m.molecule_id \nWHERE \n  m.molecule_id = 'TR001'",
  "SELECT molecule_id FROM bond WHERE bond_type ='= '",
  "SELECT a1.atom_id, a2.atom_id\nFROM (\n  SELECT b.bond_id, a1.atom_id, a2.atom_id\n  FROM connected c\n  JOIN bond b ON c.bond_id = b.bond_id\n  JOIN atom a1 ON c.atom_id = a1.atom_id\n  JOIN atom a2 ON c.atom_id2 = a2.atom_id\n  WHERE b.bond_type = '#'\n) AS triple_bonds\nJOIN atom a1 ON triple_bonds.atom_id = a1.atom_id\nJOIN atom a2 ON triple_bonds.atom_id2 = a2.atom_id",
  "SELECT \n  a.element\nFROM \n  connected c \n  JOIN bond b ON c.bond_id = b.bond_id\n  JOIN atom a ON c.atom_id = a.atom_id\nWHERE \n  b.bond_id = 'TR000_1_2'",
  "SELECT COUNT(*)\nFROM molecule m\nJOIN bond b ON m.molecule_id = b.molecule_id\nJOIN connected c ON b.bond_id = c.bond_id\nWHERE b.bond_type = '-' AND m.label = '-'",
  "SELECT m.label\nFROM molecule m\nJOIN connected c ON m.molecule_id = c.molecule_id\nJOIN bond b ON c.atom_id = b.atom_id OR c.atom_id2 = b.atom_id\nWHERE b.molecule_id = (SELECT b2.molecule_id FROM bond b2 WHERE b2.bond_id = 'TR001_10_11')",
  "SELECT \n    b.bond_id, \n    m.label\nFROM \n    bond b\nJOIN \n    molecule m ON b.molecule_id = m.molecule_id\nWHERE \n    b.bond_type = '#'",
  "SELECT \n  element, \n  COUNT(*) \nFROM \n  (SELECT \n     atom.element, \n     molecule.label \n   FROM \n     atom \n   JOIN \n     connected ON atom.atom_id = connected.atom_id \n   JOIN \n     connected AS connected2 ON connected.atom_id2 = connected2.atom_id \n   JOIN \n     bond ON connected2.bond_id = bond.bond_id \n   JOIN \n     molecule ON bond.molecule_id = molecule.molecule_id \n   WHERE \n     molecule.label = '+') AS carcinogenic_atoms \nGROUP BY \n  element",
  "SELECT \n  DIVIDE(SUM(CASE WHEN a.element = 'h' THEN 1 ELSE 0 END), COUNT(a.element)) AS ratio, \n  m.label \nFROM \n  molecule m \n  JOIN atom a ON m.molecule_id = a.molecule_id \nWHERE \n  m.molecule_id = 'TR006' \nGROUP BY \n  m.label",
  "SELECT m.label\nFROM molecule m\nJOIN atom a ON m.molecule_id = a.molecule_id\nWHERE a.element = 'ca'",
  "SELECT \n    bond_type \nFROM \n    bond \nWHERE \n    molecule_id IN (\n        SELECT \n            molecule_id \n        FROM \n            atom \n        WHERE \n            element = 'c'\n    ) \nGROUP BY \n    bond_type \nORDER BY \n    COUNT(*) DESC",
  "SELECT DISTINCT a1.element, a2.element\nFROM connected c\nJOIN atom a1 ON c.atom_id = a1.atom_id\nJOIN atom a2 ON c.atom_id2 = a2.atom_id\nJOIN bond b ON c.bond_id = b.bond_id\nWHERE b.bond_id = 'TR001_10_11'",
  "SELECT \n    COUNT(*) AS triple_bond_count,\n    (COUNT(*) * 100.0) / (SELECT COUNT(*) FROM molecule) AS triple_bond_percent\nFROM \n    bond \nWHERE \n    bond_type = '#'",
  "SELECT \n    DIVIDE(SUM(CASE WHEN b.bond_type = '=' THEN 1 ELSE 0 END), COUNT(b.bond_id)) as percent\nFROM \n    bond b\nWHERE \n    b.molecule_id = 'TR047'",
  "SELECT m.label\nFROM molecule m\nJOIN atom a ON m.molecule_id = a.molecule_id\nJOIN connected c ON a.atom_id = c.atom_id\nJOIN bond b ON c.bond_id = b.bond_id\nWHERE a.element = 'TR001_1'\nAND m.label = '+'",
  "SELECT m.label \nFROM molecule m \nWHERE m.molecule_id = 'TR151'",
  "SELECT DISTINCT\n  a.element\nFROM\n  atom a\n  JOIN molecule m ON a.molecule_id = m.molecule_id\nWHERE\n  m.label = 'TR151'\n  AND a.element IN ('cl', 'br', 'f', 'i', 'as','sb', 'pb', 'te','sn', 'ca')\nORDER BY\n  a.element",
  "SELECT COUNT(DISTINCT m.molecule_id)\nFROM molecule m\nWHERE m.label = '+'",
  "SELECT a.element\nFROM atom a\nJOIN molecule m ON a.molecule_id = m.molecule_id\nWHERE m.molecule_id BETWEEN 'TR010' AND 'TR050'\nAND a.element = 'c'",
  "SELECT COUNT(*)\nFROM atom\nWHERE atom.molecule_id IN (\n  SELECT molecule_id\n  FROM molecule\n  WHERE label = '+'\n)",
  "SELECT bond.bond_id\nFROM bond\nJOIN connected ON bond.bond_id = connected.bond_id\nJOIN atom ON connected.atom_id = atom.atom_id\nJOIN molecule ON atom.molecule_id = molecule.molecule_id\nWHERE molecule.label = '+' AND bond.bond_type = '='",
  "SELECT COUNT(*)\nFROM atom\nWHERE molecule_id IN (\n  SELECT molecule_id\n  FROM molecule\n  WHERE label = '+'\n) AND element = 'h'",
  "SELECT m.molecule_id\nFROM molecule m\nJOIN connected c ON m.molecule_id = c.molecule_id\nJOIN bond b ON c.molecule_id = b.molecule_id\nWHERE c.atom_id = \n  (SELECT a.atom_id\n   FROM atom a\n   JOIN connected c2 ON a.atom_id = c2.atom_id\n   WHERE c2.atom_id2 = \n     (SELECT b.atom_id2\n      FROM bond b\n      WHERE b.bond_id = 'TR000_1_2'))\nAND b.bond_type ='single'",
  "",
  "SELECT \n  DIVIDE(SUM(CASE WHEN m.label = '+' AND a.element = 'h' THEN 1 ELSE 0 END), \n         COUNT(DISTINCT m.molecule_id)) * 100.0 AS percentage\nFROM \n  molecule m \n  JOIN atom a ON m.molecule_id = a.molecule_id\nWHERE \n  m.label = '+' AND a.element = 'h'",
  "SELECT m.label\nFROM molecule m\nWHERE m.molecule_id = 'TR124' AND m.label = '+'"
]